<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title></title>
<!--Generated by LaTeXML (version 0.7.9alpha) http://dlmf.nist.gov/LaTeXML/.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../../../../../../LaTeXML.css" type="text/css">
<link rel="stylesheet" href="../../../../../../../ltx-article.css" type="text/css">
<link rel="stylesheet" href="../../../../../../../customRules.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div class="ltx_document">
<div id="Sx1" class="ltx_section">
<h1 class="ltx_title ltx_title_section">Wavelet filter</h1>

<div id="Sx1.p1" class="ltx_para">
<p class="ltx_p">The wavelet transform is commonly used in modern signal-processing
applications. This type of wavelet filter applies the <em class="ltx_emph">à trous</em>
algorithm <cite class="ltx_cite">[<a href="#bib.bib29" title="Astronomical Image and Data Analysis" class="ltx_ref">2</a>, <a href="#bib.bib13" title="Wavelet analysis for single molecule localization microscopy" class="ltx_ref">1</a>]</cite> which is an undecimated scheme
in which the filter responses are up-sampled, thereby inserting holes
(<em class="ltx_emph">trous</em> in French) between the filter coefficients. The output
of each filter level therefore contains the same number of samples
as the input.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p class="ltx_p">The first step is based on separable <a href="Convolution.html" title="" class="ltx_ref">convolution</a>
to obtain the smoothed approximations</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<table id="Sx1.E1" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E1.m1" class="ltx_Math" style="vertical-align:-6px" src="mi/mi9.png" width="173" height="25" alt="V_{i}=\left(V_{i-1}*\boldsymbol{k}_{i}\right)*\boldsymbol{k}_{i}^{\top}\,,"></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(1)</span></td>
</tr>
</table>
<p class="ltx_p">where <img id="Sx1.p3.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi15.png" width="55" height="18" alt="V_{0}=I"> is the input image, <img id="Sx1.p3.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi20.png" width="98" height="19" alt="i=1,\ldots,N">, and <img id="Sx1.p3.m3" class="ltx_Math" style="vertical-align:-5px" src="mi/mi19.png" width="21" height="19" alt="\boldsymbol{k}_{i}">
is a filter kernel at the corresponding level. The number of levels
is given by <img id="Sx1.p3.m4" class="ltx_Math" style="vertical-align:-2px" src="mi/mi14.png" width="20" height="16" alt="N">. The convolution kernel is usually based on a third-order
B-spline scaling function <cite class="ltx_cite">[<a href="#bib.bib29" title="Astronomical Image and Data Analysis" class="ltx_ref">2</a>, <a href="#bib.bib13" title="Wavelet analysis for single molecule localization microscopy" class="ltx_ref">1</a>]</cite>, where <img id="Sx1.p3.m5" class="ltx_Math" style="vertical-align:-8px" src="mi/mi16.png" width="175" height="29" alt="\boldsymbol{k}_{1}=\left[\frac{1}{16},\frac{1}{4},\frac{3}{8},\frac{1}{4},%
\frac{1}{16}\right]^{\top}">,
<img id="Sx1.p3.m6" class="ltx_Math" style="vertical-align:-8px" src="mi/mi17.png" width="242" height="29" alt="\boldsymbol{k}_{2}=\left[\frac{1}{16},0,\frac{1}{4},0,\frac{3}{8},0,\frac{1}{4%
},0,\frac{1}{16}\right]^{\top}">,
<img id="Sx1.p3.m7" class="ltx_Math" style="vertical-align:-8px" src="mi/mi18.png" width="376" height="29" alt="\boldsymbol{k}_{3}=\left[\frac{1}{16},0,0,0,\frac{1}{4},0,0,0,\frac{3}{8},0,0,%
0,\frac{1}{4},0,0,0,\frac{1}{16}\right]^{\top}">,
etc.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p class="ltx_p">The wavelet transform of the input data at level <img id="Sx1.p4.m1" class="ltx_Math" style="vertical-align:-2px" src="mi/mi21.png" width="10" height="15" alt="i"> is computed
as the difference between two consecutive approximation levels</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<table id="Sx1.E2" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E2.m1" class="ltx_Math" style="vertical-align:-6px" src="mi/mi8.png" width="125" height="20" alt="F_{i}=V_{i-1}-V_{i}\,."></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(2)</span></td>
</tr>
</table>
<p class="ltx_p">Here, each wavelet level corresponds to different ranges of spatial
frequencies. The first level <img id="Sx1.p5.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi10.png" width="23" height="18" alt="F_{1}"> contains mainly the high spatial
frequencies present in the input image including noise. Higher levels
contain ranges of lower and lower image frequency components.</p>
</div>
<div id="Sx1.p6" class="ltx_para">
<p class="ltx_p">In our implementation, the output of the wavelet filter is the second
wavelet level <img id="Sx1.p6.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi11.png" width="23" height="18" alt="F_{2}"> (optionally the third, <img id="Sx1.p6.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi12.png" width="23" height="18" alt="F_{3}">), because at
this level, most localization microscopy data contains structures
with sizes close to the diffraction limit of the microscope (we note
that this depends on the effective camera pixel size). The wavelet
filter is the default option in ThunderSTORM as it performs very well
on many of the localization microscopy data sets we have experimented
with.</p>
</div>
<div id="Sx1.SSx1" class="ltx_subsection">
<h2 class="ltx_title ltx_title_subsection">Detector threshold formula</h2>

<div id="Sx1.SSx1.p1" class="ltx_para">
<p class="ltx_p">Refer to <a href="../../detectors/Threshold.html" title="" class="ltx_ref">Threshold</a> to see
how filter results can be used to dynamically find threshold value.</p>
</div>
<div id="Sx1.SSx1.p2" class="ltx_para">
<p class="ltx_p">This filter provides the two default variables and all the calculated
wavelet levels <img id="Sx1.SSx1.p2.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi13.png" width="21" height="18" alt="F_{i}">:</p>
</div>
<div id="Sx1.SSx1.p3" class="ltx_para">
<table class="ltx_tabular">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.I</span></th>
<th class="ltx_td ltx_align_left">current unfiltered image</th>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F</span></th>
<th class="ltx_td ltx_align_left">current filtered image</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F1</span></th>
<td class="ltx_td ltx_align_left">first wavelet level <img id="Sx1.SSx1.p3.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi10.png" width="23" height="18" alt="F_{1}"> of the current image</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F2</span></th>
<td class="ltx_td ltx_align_left">second wavelet level <img id="Sx1.SSx1.p3.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi11.png" width="23" height="18" alt="F_{2}"> of the current image</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F3</span></th>
<td class="ltx_td ltx_align_left">third wavelet level <img id="Sx1.SSx1.p3.m3" class="ltx_Math" style="vertical-align:-5px" src="mi/mi12.png" width="23" height="18" alt="F_{3}"> of the current image</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="bib" class="ltx_bibliography">
<h1 class="ltx_title ltx_title_bibliography">References</h1>

<ul id="L1" class="ltx_biblist">
<li id="bib.bib13" class="ltx_bibitem ltx_bib_article">
<span class="ltx_bibtag ltx_bib_key ltx_role_refnum">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_author">I. Izeddin, J. Boulanger, V. Racine, C. G. Specht, A. Kechkar, D. Nair, A. Triller, D. Choquet, M. Dahan and J. B. Sibarita</span><span class="ltx_text ltx_bib_year">(2012)</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_title">Wavelet analysis for single molecule localization microscopy</span>,
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_journal">Optics Express</span> <span class="ltx_text ltx_bib_volume">20</span> (<span class="ltx_text ltx_bib_number">3</span>), <span class="ltx_text ltx_bib_pages"> pp. 2081–95</span>.
</span>
<span class="ltx_bibblock">External Links: <span class="ltx_text ltx_bib_links"><a href="http://dx.doi.org/10.1364/OE.20.002081" title="" class="ltx_ref doi ltx_bib_external">Document</a></span>.
</span>
<span class="ltx_bibblock ltx_bib_cited">Cited by: <a href="#Sx1.p1" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>,
<a href="#Sx1.p3" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>.
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem ltx_bib_book">
<span class="ltx_bibtag ltx_bib_key ltx_role_refnum">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_author">J.-L. Starck and F. Murtagh</span><span class="ltx_text ltx_bib_year">(2002)</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_title">Astronomical Image and Data Analysis</span>,
</span>
<span class="ltx_bibblock"> <span class="ltx_text ltx_bib_publisher">Springer-Verlag</span>.
</span>
<span class="ltx_bibblock ltx_bib_cited">Cited by: <a href="#Sx1.p1" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>,
<a href="#Sx1.p3" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>.
</span>
</li>
</ul>
</div>
</div>
</div>
<div class="ltx_page_footer">
<div class="ltx_page_logo">Generated  by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div>
</div>
</div>
</body>
</html>
