<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title></title>
<!--Generated by LaTeXML (version 0.7.9alpha) http://dlmf.nist.gov/LaTeXML/.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../../../../LaTeXML.css" type="text/css">
<link rel="stylesheet" href="../../../../../ltx-article.css" type="text/css">
<link rel="stylesheet" href="../../../../../customRules.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div class="ltx_document">
<div id="Sx1" class="ltx_section">
<h1 class="ltx_title ltx_title_section">Artificial data generator</h1>

<div id="Sx1.p1" class="ltx_para">
<p class="ltx_p">The synthetic data generator forms images using a probabilistic model
based on user-supplied parameters. In addition to the image dimensions
and sequence length,</p>
</div>
<div id="Sx1.SSx1" class="ltx_subsection">
<h2 class="ltx_title ltx_title_subsection">Image formation</h2>

<div id="Sx1.SSx1.p1" class="ltx_para">
<p class="ltx_p">users can choose the pixel-size <img id="Sx1.SSx1.p1.m1" class="ltx_Math" style="vertical-align:-2px" src="mi/mi25.png" width="13" height="11" alt="a"> (nm), the density of molecules
<img id="Sx1.SSx1.p1.m2" class="ltx_Math" style="vertical-align:-2px" src="mi/mi12.png" width="19" height="16" alt="D"> (molecules per <img id="Sx1.SSx1.p1.m3" class="ltx_Math" style="vertical-align:-5px" src="mi/mi24.png" width="37" height="22" alt="\upmu\textrm{m}^{2}">), the emitter intensity
range <img id="Sx1.SSx1.p1.m4" class="ltx_Math" style="vertical-align:-2px" src="mi/mi2.png" width="13" height="16" alt="I"> (photons), the emitter FWHM range (pixels), and the variance
of additive Poisson noise <img id="Sx1.SSx1.p1.m5" class="ltx_Math" style="vertical-align:-2px" src="mi/mi17.png" width="14" height="16" alt="\lambda"> (photons). The software can also
simulate linear drift of the sample over time. We first generate a
background which is static for all the images in the sequence. Then
for each frame a set of molecules is generated and added to the image.
If drift was specified, the image is shifted. Additive noise is then
applied. The process can be summarized as follows</p>
<table id="Sx1.E1" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E1.m1" class="ltx_Math" style="vertical-align:-6px" src="mi/mi10.png" width="295" height="21" alt="image=\mathrm{{drift}}(\mathrm{PSF_{IG}}(X\mid\theta))+\mathcal{P}(\lambda)\,,"></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(1)</span></td>
</tr>
</table>
<p class="ltx_p">where <img id="Sx1.SSx1.p1.m6" class="ltx_Math" style="vertical-align:-6px" src="mi/mi20.png" width="42" height="21" alt="\mathcal{P}(\lambda)"> is a Poisson distributed variable with
parameter <img id="Sx1.SSx1.p1.m7" class="ltx_Math" style="vertical-align:-2px" src="mi/mi17.png" width="14" height="16" alt="\lambda"> and <img id="Sx1.SSx1.p1.m8" class="ltx_Math" style="vertical-align:-6px" src="mi/mi22.png" width="107" height="21" alt="\mathrm{PSF_{IG}}(X\mid\theta)"> is an <a href="estimators/ui/IntSymmetricGaussianEstimatorUI.html" title="" class="ltx_ref">integrated bi-variate Gaussian PSF</a>.</p>
</div>
<div id="Sx1.SSx1.p2" class="ltx_para">
<p class="ltx_p">The parameters <img id="Sx1.SSx1.p2.m1" class="ltx_Math" style="vertical-align:-2px" src="mi/mi23.png" width="12" height="16" alt="\theta"> are picked randomly from a uniform distribution
<img id="Sx1.SSx1.p2.m2" class="ltx_Math" style="vertical-align:-2px" src="mi/mi21.png" width="17" height="16" alt="\mathcal{U}"> within the range of user-specified values. Thus</p>
<table id="Sx1.E2" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E2.m1" class="ltx_Math" style="vertical-align:-6px" src="mi/mi9.png" width="379" height="26" alt="\theta=\{\mathcal{U}(x_{0}),\mathcal{U}(y_{0}),\mathcal{U}(I),\mathrm{\mathcal%
{U}({FWHM}/(2\sqrt{{2\ln 2}})})\}\,."></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(2)</span></td>
</tr>
</table>
</div>
<div id="Sx1.SSx1.p3" class="ltx_para">
<p class="ltx_p">To simulate the EM gain, we use a stochastic model described in <cite class="ltx_cite">[<a href="#bib.bib5" title="A stochastic model for electron multiplication charge-coupled devices–from theory to practice." class="ltx_ref">1</a>]</cite>.
The EM register is modeled using the Gamma distribution <img id="Sx1.SSx1.p3.m1" class="ltx_Math" style="vertical-align:-6px" src="mi/mi16.png" width="55" height="21" alt="\Gamma(k,g)">
with its shape determined by the number of photo-electrons in the
register <img id="Sx1.SSx1.p3.m2" class="ltx_Math" style="vertical-align:-2px" src="mi/mi26.png" width="13" height="16" alt="k"> and scale given by the value of gain <img id="Sx1.SSx1.p3.m3" class="ltx_Math" style="vertical-align:-5px" src="mi/mi4.png" width="13" height="15" alt="g">.</p>
</div>
</div>
<div id="Sx1.SSx2" class="ltx_subsection">
<h2 class="ltx_title ltx_title_subsection">Spatial density of molecules</h2>

<div id="Sx1.SSx2.p1" class="ltx_para">
<p class="ltx_p">Users can specify a fixed density of molecules for the whole image
or a varying density by supplying a gray-scale mask <img id="Sx1.SSx2.p1.m1" class="ltx_Math" style="vertical-align:-2px" src="mi/mi14.png" width="23" height="16" alt="M"> in which
the intensities are used in the probability model which determine
the probability of a molecule to appear at any given pixel,</p>
<table id="Sx1.E3" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E3.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi8.png" width="114" height="22" alt="\mathbb{P}=a^{2}D\cdot M_{i}\,."></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(3)</span></td>
</tr>
</table>
<p class="ltx_p"><img id="Sx1.SSx2.p1.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi15.png" width="27" height="18" alt="M_{i}"> is the intensity of the <img id="Sx1.SSx2.p1.m3" class="ltx_Math" style="vertical-align:-2px" src="mi/mi5.png" width="10" height="15" alt="i">-th pixel in mask <img id="Sx1.SSx2.p1.m4" class="ltx_Math" style="vertical-align:-5px" src="mi/mi13.png" width="27" height="19" alt="M,"> normalized
to the interval <img id="Sx1.SSx2.p1.m5" class="ltx_Math" style="vertical-align:-6px" src="mi/mi11.png" width="43" height="21" alt="(0,1)"> to represent a probability. For each pixel,
the generator randomly picks a uniformly distributed value <img id="Sx1.SSx2.p1.m6" class="ltx_Math" style="vertical-align:-6px" src="mi/mi28.png" width="74" height="21" alt="p\in(0,1)">
and if <img id="Sx1.SSx2.p1.m7" class="ltx_Math" style="vertical-align:-5px" src="mi/mi29.png" width="47" height="19" alt="p\leq\mathbb{P}"> a molecule is placed inside the pixel with
a random offset from its center. If the density in a single pixel
is higher than one molecule, the value <img id="Sx1.SSx2.p1.m8" class="ltx_Math" style="vertical-align:-2px" src="mi/mi19.png" width="15" height="16" alt="\mathbb{P}"> is greater than
one. In that case the generator renders a molecule, updates <img id="Sx1.SSx2.p1.m9" class="ltx_Math" style="vertical-align:-3px" src="mi/mi18.png" width="79" height="17" alt="\mathbb{P}=\mathbb{P}-1">,
picks a new <img id="Sx1.SSx2.p1.m10" class="ltx_Math" style="vertical-align:-5px" src="mi/mi7.png" width="13" height="15" alt="p">, and continues generating new molecules until <img id="Sx1.SSx2.p1.m11" class="ltx_Math" style="vertical-align:-5px" src="mi/mi27.png" width="47" height="19" alt="p&gt;\mathbb{P}">.</p>
</div>
</div>
</div>
<div id="bib" class="ltx_bibliography">
<h1 class="ltx_title ltx_title_bibliography">References</h1>

<ul id="L1" class="ltx_biblist">
<li id="bib.bib5" class="ltx_bibitem ltx_bib_article">
<span class="ltx_bibtag ltx_bib_key ltx_role_refnum">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_author">M. Hirsch, R. J. Wareham, M. L. Martin-Fernandez, M. P. Hobson and D. J. Rolfe</span><span class="ltx_text ltx_bib_year">(2013-01)</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_title">A stochastic model for electron multiplication charge-coupled devices–from theory to practice.</span>,
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_journal">PloS one</span> <span class="ltx_text ltx_bib_volume">8</span> (<span class="ltx_text ltx_bib_number">1</span>), <span class="ltx_text ltx_bib_pages"> pp. e53671</span>.
</span>
<span class="ltx_bibblock">External Links: <span class="ltx_text ltx_bib_links"><a href="http://dx.doi.org/10.1371/journal.pone.0053671" title="" class="ltx_ref doi ltx_bib_external">Document</a>,
<span class="ltx_text issn ltx_bib_external">ISSN 1932-6203</span></span>.
</span>
<span class="ltx_bibblock ltx_bib_cited">Cited by: <a href="#Sx1.SSx1.p3" title="Image formation ‣ Artificial data generator" class="ltx_ref"><span class="ltx_text ltx_ref_title">Image formation</span></a>.
</span>
</li>
</ul>
</div>
</div>
</div>
<div class="ltx_page_footer">
<div class="ltx_page_logo">Generated  by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div>
</div>
</div>
</body>
</html>
