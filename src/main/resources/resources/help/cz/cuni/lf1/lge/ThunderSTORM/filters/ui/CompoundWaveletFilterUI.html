<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title></title>
<!--Generated by LaTeXML (version 0.7.9alpha) http://dlmf.nist.gov/LaTeXML/.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../../../../../../LaTeXML.css" type="text/css">
<link rel="stylesheet" href="../../../../../../../ltx-article.css" type="text/css">
<link rel="stylesheet" href="../../../../../../../customRules.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<div class="ltx_document">
<div id="Sx1" class="ltx_section">
<h1 class="ltx_title ltx_title_section">Wavelet filter</h1>

<div id="Sx1.p1" class="ltx_para">
<p class="ltx_p">The wavelet transform is commonly used in modern signal-processing
applications. This type of wavelet filter applies the <em class="ltx_emph">à trous</em>
algorithm <cite class="ltx_cite">[<a href="#bib.bib33" title="Astronomical Image and Data Analysis" class="ltx_ref">2</a>, <a href="#bib.bib16" title="Wavelet analysis for single molecule localization microscopy" class="ltx_ref">1</a>]</cite> which is an undecimated scheme
in which the filter responses are up-sampled, thereby inserting holes
(<em class="ltx_emph">trous</em> in French) between the filter coefficients. The output
of each filter level, therefore, contains the same number of samples
as the input.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p class="ltx_p">The first step of the filtering is based on separable <a href="Convolution.html" title="" class="ltx_ref">convolution</a>
to obtain the smoothed approximations</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<table id="Sx1.E1" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E1.m1" class="ltx_Math" style="vertical-align:-9px" src="mi/mi11.png" width="183" height="27" alt="V_{f}=\left(V_{f-1}*\boldsymbol{k}_{f}\right)*\boldsymbol{k}_{f}^{\top}\,,"></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(1)</span></td>
</tr>
</table>
<p class="ltx_p">where <img id="Sx1.p3.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi18.png" width="55" height="18" alt="V_{0}=I"> is the input image, <img id="Sx1.p3.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi25.png" width="102" height="19" alt="f=1,\ldots,N"> are the levels,
<img id="Sx1.p3.m3" class="ltx_Math" style="vertical-align:-7px" src="mi/mi22.png" width="191" height="22" alt="\boldsymbol{k}_{f}=\left[k_{1,f},k_{2,f},\ldots,k_{l,f}\right]">
is a filter kernel at the corresponding level, and <img id="Sx1.p3.m4" class="ltx_Math" style="vertical-align:-2px" src="mi/mi6.png" width="9" height="16" alt="l"> is the kernel
size. The number of levels is given by <img id="Sx1.p3.m5" class="ltx_Math" style="vertical-align:-2px" src="mi/mi17.png" width="20" height="16" alt="N">.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p class="ltx_p">The wavelet transform of the input data at level <img id="Sx1.p4.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi26.png" width="14" height="19" alt="f"> is computed
as the difference between two consecutive approximation levels</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<table id="Sx1.E2" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E2.m1" class="ltx_Math" style="vertical-align:-7px" src="mi/mi10.png" width="135" height="21" alt="F_{f}=V_{f-1}-V_{f}\,."></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(2)</span></td>
</tr>
</table>
<p class="ltx_p">This expression acts as a band-pass filter, therefore each wavelet
level corresponds to a different range of spatial frequencies. The
first level <img id="Sx1.p5.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi13.png" width="23" height="18" alt="F_{1}"> contains mainly the high spatial frequencies
present in the input image including noise. Higher levels contain
ranges of lower and lower image frequency components.</p>
</div>
<div id="Sx1.p6" class="ltx_para">
<p class="ltx_p">In our case, the output of the wavelet filter is the second wavelet
level <img id="Sx1.p6.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi14.png" width="23" height="18" alt="F_{2}">. The standard deviation of values obtained in the first
wavelet level <img id="Sx1.p6.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi13.png" width="23" height="18" alt="F_{1}"> can be used as a threshold in the filtered
image for an approximate localization of molecules <cite class="ltx_cite">[<a href="#bib.bib16" title="Wavelet analysis for single molecule localization microscopy" class="ltx_ref">1</a>]</cite>.</p>
</div>
<div id="Sx1.p7" class="ltx_para">
<p class="ltx_p">The wavelet filter uses a convolution kernel based on normalized B-spline
basis functions <cite class="ltx_cite">[<a href="#bib.bib33" title="Astronomical Image and Data Analysis" class="ltx_ref">2</a>, <a href="#bib.bib16" title="Wavelet analysis for single molecule localization microscopy" class="ltx_ref">1</a>]</cite>. The <img id="Sx1.p7.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi27.png" width="12" height="19" alt="j">-th B-spline
basis function of degree <img id="Sx1.p7.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi33.png" width="58" height="21" alt="q\in\mathbb{N}^{+}"> in the variable <img id="Sx1.p7.m3" class="ltx_Math" style="vertical-align:-3px" src="mi/mi37.png" width="44" height="17" alt="t\in\mathbb{R}">,
written as <img id="Sx1.p7.m4" class="ltx_Math" style="vertical-align:-7px" src="mi/mi12.png" width="58" height="22" alt="B_{j,q}\left(t\right)">, is defined recursively as follows.
For <img id="Sx1.p7.m5" class="ltx_Math" style="vertical-align:-5px" src="mi/mi30.png" width="45" height="19" alt="q=1">,</p>
<table id="Sx1.E3" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E3.m1" class="ltx_Math" style="vertical-align:-24px" src="mi/mi8.png" width="248" height="57" alt="B_{j,1}\left(t\right)=\begin{cases}1&amp;\mathrm{if}\;t_{j}\leq t&lt;t_{j+1}\,,\\
0&amp;\mathrm{otherwise}\,,\end{cases}"></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(3)</span></td>
</tr>
</table>
<p class="ltx_p">and for <img id="Sx1.p7.m6" class="ltx_Math" style="vertical-align:-5px" src="mi/mi31.png" width="45" height="19" alt="q&gt;1">,</p>
<table id="Sx1.E4" class="ltx_equation">

<tr class="ltx_equation ltx_align_baseline">
<td class="ltx_eqn_pad"></td>
<td class="ltx_align_center"><img id="Sx1.E4.m1" class="ltx_Math" style="vertical-align:-19px" src="mi/mi9.png" width="454" height="44" alt="B_{j,q}\left(t\right)=\frac{t-t_{j}}{t_{j+q-1}-t_{j}}B_{j,q-1}\left(t\right)+%
\frac{t_{j+q}-t}{t_{j+q}-t_{j+1}}B_{j+1,q-1}\left(t\right)."></td>
<td class="ltx_eqn_pad"></td>
<td rowspan="1" class="ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation">(4)</span></td>
</tr>
</table>
<p class="ltx_p">Here <img id="Sx1.p7.m7" class="ltx_Math" style="vertical-align:-7px" src="mi/mi12.png" width="58" height="22" alt="B_{j,q}\left(t\right)"> has non-zero values in the interval
<img id="Sx1.p7.m8" class="ltx_Math" style="vertical-align:-7px" src="mi/mi38.png" width="103" height="21" alt="t_{j}\leq t&lt;t_{j+q}">.</p>
</div>
<div id="Sx1.p8" class="ltx_para">
<p class="ltx_p">For the first wavelet level, the convolution kernel <img id="Sx1.p8.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi20.png" width="23" height="19" alt="\boldsymbol{k}_{1}">
in Equation (<a href="#Sx1.E1" title="(1) ‣ Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is composed from values <img id="Sx1.p8.m2" class="ltx_Math" style="vertical-align:-8px" src="mi/mi28.png" width="226" height="25" alt="k_{i,1}\left(x\mid q,s\right)=aB_{0,q}\left(\frac{x}{s}+\frac{q}{2}\right)">,
where <img id="Sx1.p8.m3" class="ltx_Math" style="vertical-align:-5px" src="mi/mi4.png" width="87" height="19" alt="i=1,\ldots,l">, <img id="Sx1.p8.m4" class="ltx_Math" style="vertical-align:-6px" src="mi/mi39.png" width="136" height="21" alt="x=i-\left(l+1\right)/2">, the kernel size
<img id="Sx1.p8.m5" class="ltx_Math" style="vertical-align:-8px" src="mi/mi29.png" width="110" height="25" alt="l=2\left\lceil\frac{qs}{2}\right\rceil-1">, <img id="Sx1.p8.m6" class="ltx_Math" style="vertical-align:-3px" src="mi/mi35.png" width="44" height="16" alt="s&gt;0"> is a sampling
factor, and <img id="Sx1.p8.m7" class="ltx_Math" style="vertical-align:-2px" src="mi/mi24.png" width="13" height="11" alt="a"> is a constant scaling factor such that <img id="Sx1.p8.m8" class="ltx_Math" style="vertical-align:-7px" src="mi/mi23.png" width="90" height="22" alt="\sum_{i}k_{i,1}=1">.
Kernels for higher wavelet levels are obtained by inserting zeros
between the kernel coefficients. Users need to input the degree <img id="Sx1.p8.m9" class="ltx_Math" style="vertical-align:-5px" src="mi/mi32.png" width="12" height="15" alt="q">
of the B-spline basis function and the sampling factor <img id="Sx1.p8.m10" class="ltx_Math" style="vertical-align:-2px" src="mi/mi36.png" width="12" height="11" alt="s">.</p>
</div>
<div id="Sx1.p9" class="ltx_para">
<p class="ltx_p">In our implementation, the default kernel uses a B-spline basis function
of the third degree with a sampling factor <img id="Sx1.p9.m1" class="ltx_Math" style="vertical-align:-2px" src="mi/mi34.png" width="44" height="15" alt="s=2">. These settings
yield kernels <img id="Sx1.p9.m2" class="ltx_Math" style="vertical-align:-8px" src="mi/mi19.png" width="175" height="29" alt="\boldsymbol{k}_{1}=\left[\frac{1}{16},\frac{1}{4},\frac{3}{8},\frac{1}{4},%
\frac{1}{16}\right]^{\top}">
and <img id="Sx1.p9.m3" class="ltx_Math" style="vertical-align:-8px" src="mi/mi21.png" width="242" height="29" alt="\boldsymbol{k}_{2}=\left[\frac{1}{16},0,\frac{1}{4},0,\frac{3}{8},0,\frac{1}{4%
},0,\frac{1}{16}\right]^{\top}">,
as suggested in <cite class="ltx_cite">[<a href="#bib.bib33" title="Astronomical Image and Data Analysis" class="ltx_ref">2</a>, <a href="#bib.bib16" title="Wavelet analysis for single molecule localization microscopy" class="ltx_ref">1</a>]</cite>.</p>
</div>
<div id="Sx1.SSx1" class="ltx_subsection">
<h2 class="ltx_title ltx_title_subsection">Detector threshold formula</h2>

<div id="Sx1.SSx1.p1" class="ltx_para">
<p class="ltx_p">Refer to <a href="../../detectors/Threshold.html" title="" class="ltx_ref">Threshold</a> to see
how filter results can be used to dynamically find threshold value.</p>
</div>
<div id="Sx1.SSx1.p2" class="ltx_para">
<p class="ltx_p">This filter provides the two default variables and all the calculated
wavelet levels <img id="Sx1.SSx1.p2.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi16.png" width="21" height="18" alt="F_{i}">:</p>
</div>
<div id="Sx1.SSx1.p3" class="ltx_para">
<table class="ltx_tabular">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.I</span></th>
<th class="ltx_td ltx_align_left">current unfiltered image</th>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F</span></th>
<th class="ltx_td ltx_align_left">current filtered image</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F1</span></th>
<td class="ltx_td ltx_align_left">first wavelet level <img id="Sx1.SSx1.p3.m1" class="ltx_Math" style="vertical-align:-5px" src="mi/mi13.png" width="23" height="18" alt="F_{1}"> of the current image</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F2</span></th>
<td class="ltx_td ltx_align_left">second wavelet level <img id="Sx1.SSx1.p3.m2" class="ltx_Math" style="vertical-align:-5px" src="mi/mi14.png" width="23" height="18" alt="F_{2}"> of the current image</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left"><span class="ltx_text ltx_lstlisting ltx_font_typewriter">Wave.F3</span></th>
<td class="ltx_td ltx_align_left">third wavelet level <img id="Sx1.SSx1.p3.m3" class="ltx_Math" style="vertical-align:-5px" src="mi/mi15.png" width="23" height="18" alt="F_{3}"> of the current image</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="bib" class="ltx_bibliography">
<h1 class="ltx_title ltx_title_bibliography">References</h1>

<ul id="L1" class="ltx_biblist">
<li id="bib.bib16" class="ltx_bibitem ltx_bib_article">
<span class="ltx_bibtag ltx_bib_key ltx_role_refnum">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_author">I. Izeddin, J. Boulanger, V. Racine, C. G. Specht, A. Kechkar, D. Nair, A. Triller, D. Choquet, M. Dahan and J. B. Sibarita</span><span class="ltx_text ltx_bib_year">(2012)</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_title">Wavelet analysis for single molecule localization microscopy</span>,
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_journal">Optics Express</span> <span class="ltx_text ltx_bib_volume">20</span> (<span class="ltx_text ltx_bib_number">3</span>), <span class="ltx_text ltx_bib_pages"> pp. 2081–95</span>.
</span>
<span class="ltx_bibblock">External Links: <span class="ltx_text ltx_bib_links"><a href="http://dx.doi.org/10.1364/OE.20.002081" title="" class="ltx_ref doi ltx_bib_external">Document</a></span>.
</span>
<span class="ltx_bibblock ltx_bib_cited">Cited by: <a href="#Sx1.p1" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>,
<a href="#Sx1.p6" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>,
<a href="#Sx1.p7" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>,
<a href="#Sx1.p9" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>.
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem ltx_bib_book">
<span class="ltx_bibtag ltx_bib_key ltx_role_refnum">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_author">J.-L. Starck and F. Murtagh</span><span class="ltx_text ltx_bib_year">(2002)</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_title">Astronomical Image and Data Analysis</span>,
</span>
<span class="ltx_bibblock"> <span class="ltx_text ltx_bib_publisher">Springer-Verlag</span>.
</span>
<span class="ltx_bibblock ltx_bib_cited">Cited by: <a href="#Sx1.p1" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>,
<a href="#Sx1.p7" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>,
<a href="#Sx1.p9" title="Wavelet filter" class="ltx_ref"><span class="ltx_text ltx_ref_title">Wavelet filter</span></a>.
</span>
</li>
</ul>
</div>
</div>
</div>
<div class="ltx_page_footer">
<div class="ltx_page_logo">Generated  by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div>
</div>
</div>
</body>
</html>
